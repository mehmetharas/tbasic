$INCLUDE "KUTUP.BAS"
FILE.OPEN:
   OPEN "TASAR.DAT" FOR RANDOM AS 1 LEN = 120
   FIELD 1,3 AS SIR$,20 AS ADI$,10 AS BIR$,6 AS KES1$,8 AS TOPL$,_
           10 AS TAR1$,6 AS MIK1$,10 AS BTAR1$,10 AS BTAR2$,10 AS BORC$,_
           7 AS ACIL$,10 AS TOPK$,10 AS KALB$
ANAMENU:
   A$=FNEKRAN$("KAYGIR5.SCR")
   S$=FNRENK$("REVERSE")
   sds$="   "
   ADS$=FNINPUT$(17,40,1,SD$,1)
   IF TUS=27 THEN GOTO CIK
   IF ADS$="1" THEN GOTO YENI.KAYIT
   IF ADS$="2" THEN GOTO cik
   IF ADS$="3" THEN GOTO cik
   GOTO ANAMENU
YENI.KAYIT:
   RUZ%=LOF(1)/120 : RECNO%=RUZ%+1
   A$=FNEKRAN$("KAYGIR3.SCR")
SIRA.NO:
   S$=FNRENK$("REVERSE")
   SIRANO$=MID$(STR$(RECNO%),2)
   SIRANO$=FNINPUT$(7,31,3,SIRANO$,1)
   SIRANO$=FNSIFIR$(SIRANO$,3):LOCATE 7,31 : PRINT SIRANO$
   IF VAL(SIRANO$)>RECNO% THEN GOTO SIRA.NO
   IF TUS=27 THEN GOTO ANAMENU
   IF TUS=73 THEN GOSUB PGUP:GOTO SIRA.NO
   IF TUS=81 THEN GOSUB PGDN:GOTO SIRA.NO
   GOSUB KAYIT.KONTROL
   IF VAR=1 THEN KOM$="12"+CHR$(27) : GOTO JOBS ELSE KOM$="12"+CHR$(27)
ADSOY:
   S$=FNRENK$("REVERSE")
   ADSOY$=FNINPUT$(8,31,20,ADOSY$,0)
   IF TUS=72 THEN GOTO SIRA.NO
   IF TUS=27 THEN GOTO JOBS
CAL.BIR:
   S$=FNRENK$("REVERSE")
   BIRIM$=FNINPUT$(9,31,10,BIRIM$,0)
   IF TUS=72 THEN GOTO ADSOY
   IF TUS=27 THEN GOTO JOBS
KESILEN:
   S$=FNRENK$("REVERSE")
   KES$=FNINPUT$(10,31,6,KES$,1)
   LOCATE 10,31 : PRINT USING "\   \.\   \";KES$+"] TL"
   IF TUS=72 THEN GOTO CAL.BIR
   IF TUS=27 THEN GOTO JOBS
TOPLAM1:
   S$=FNRENK$("REVERSE")
   TOPLM$=FNINPUT$(11,31,8,TOPLM$,1)
   LOCATE 11,31 : PRINT USING "\  \.\   \.\   \";TOPLM$
   IF TUS=72 THEN GOTO KESILEN
   IF TUS=27 THEN GOTO JOBS
YUKSEK1:
   S$=FNRENK$("REVERSE")
   TAR$=FNINPUT$(13,31,10,TAR$,0)
   IF TUS=72 THEN GOTO TOPLAM1
   IF TUS=27 THEN GOTO JOBS
YUKSEK2:
   S$=FNRENK$("REVERSE")
   MIK$=FNINPUT$(14,31,6,MIK$,1)
   LOCATE 14,31 : PRINT USING "\   \.\   \";MIK$
   IF TUS=72 THEN GOTO YUKSEK1
   IF TUS=27 THEN GOTO JOBS
VERILEN:
   S$=FNRENK$("REVERSE")
   TARI$=FNINPUT$(16,31,10,TARI$,0)
   IF TUS=72 THEN GOTO YUKSEK2
   IF TUS=27 THEN GOTO JOBS
BITIS.TAR:
   S$=FNRENK$("REVERSE")
   TAR2$=FNINPUT$(17,31,10,TAR2$,0)
   IF TUS=72 THEN GOTO VERILEN
   IF TUS=27 THEN GOTO JOBS
MIKTAR.LAR:
   S$=FNRENK$("REVERSE")
   BRC$=FNINPUT$(18,31,10,BRC$,1)
   LOCATE 18,31 : PRINT USING "\ \.\   \.\   \.\   \";BRC$
   IF TUS=72 THEN GOTO BITIS.TAR
   IF TUS=27 THEN GOTO JOBS
ACIL.BRC:
   S$=FNRENK$("REVERSE")
   ACL$=FNINPUT$(19,31,7,ACL$,1)
   LOCATE 19,31 : PRINT USING "\ \.\   \.\   \";ACL$
   IF TUS=72 THEN GOTO MIKTAR.LAR
   IF TUS=27 THEN GOTO JOBS
TOPLAM.KES:
   S$=FNRENK$("REVERSE")
   TOP$=FNINPUT$(20,31,10,TOP$,1)
   LOCATE 20,31 : PRINT USING "\ \.\   \.\   \.\   \";TOP$+"] TL"
   IF TUS=72  THEN GOTO ACIL.BRC
   IF TUS=27 THEN GOTO JOBS
KALAN.BORC:
   KAL$=FNINPUT$(21,31,10,KAL$,1)
   LOCATE 21,31 : PRINT USING "\ \.\   \.\   \.\   \";KAL$
   IF TUS=72 THEN GOTO TOPLAM.KES
   IF DUZELT=1 THEN RETURN
JOBS:
   KB$=FNMESAJ$("1-KAYIT  2-DUZELT  ESC-CIKIS ",KOM$)
   SELECT CASE KB$
              CASE "1" : GOSUB KAYIT:GOTO YENI.KAYIT
              CASE "2" : GOSUB DUZELT:GOTO YENI.KAYIT
              CASE CHR$(27) :GOTO ANAMENU
     END SELECT
     GOTO JOBS

KAYIT:
    LSET SIR$=SIRANO$:LSET ADI$=ADSOY$:LSET BIR$=BIRIM$:LSET KES1$=KES$
    LSET TOPL$=TOPLM$:LSET TAR1$=TAR$ :LSET MIK1$=MIK$ :LSET BTAR$=TARI$
    LSET BTAR2$=TAR2$:LSET BORC$=BRC$ :LSET ACIL$=ACL$ :LSET TOPK$=TOP$
    LSET KALB$=KAL$
    PUT 1,RECNO%
    RETURN
DUZELT:
    DUZELT=1:GOSUB SIRA.NO
    KB$=FNMESAJ$("Duzeltmeler Kaydedilsin mi?(Ee/Hh)","EeHh")
    IF KB$="H" OR KB$="h" THEN RETURN
    VAR=1
    GOSUB KAYIT
    RETURN
SIL:
    KB$=FNMESAJ$("Eminmisiniz...(Ee/Hh)","EeHh")
    IF KB$="H" OR KB$="h" THEN RETURN
    SIRANO$="Q": GOSUB KAYIT
    RETURN
KAYIT.KONTROL:
    RECNO%=VAL(SIRANO$)-1
    IF RUZ%=RECNO% THEN VAR=0 : RETURN
    GET #1,RECNO%
    GOSUB EKRAN.YAZ
    RETURN
EKRAN.YAZ:
    SIRANO$=SIR$:ADSOY$=ADI$:BIR1$=BIR$:TAR2$=BTAR2$:BRC$=BORC$:TR$=TAR1$
    KES$=KES1$:TOPLM$=TOPL$:TAR1$=BTAR1$:ACL$=ACIL$:TOP$=TOPK$:KAL$=KALB$
    MIK$=MIK1$
    S$=FNRENK$("REVERSE")
    SIRANO$=FNSIFIR$(SIRANO$,3)
    LOCATE 7,31 : PRINT SIRANO$ :LOCATE 8,31 : PRINT ADSOY$ : LOCATE 9,31
    PRINT BIR1$:LOCATE 10,31 :PRINT KES$:LOCATE 11,31:PRINT TOPLM$:LOCATE 13,31
    PRINT TAR$:LOCATE 14,31:PRINT MIK$:LOCATE 16,31 :PRINT TAR1$:LOCATE 17,31
    PRINT TAR2$:LOCATE 18,31:PRINT BRC$:LOCATE 19,31 :PRINT ACL$:LOCATE 20,31
    PRINT TOP$:LOCATE 21,31:PRINT KAL$
    RETURN
PGUP:
    IF RECNO%<>1 THEN RECNO%=RECNO%-1
    GET 1,RECNO%
    GOSUB EKRAN.YAZ
    RETURN
PGDN:
    IF RECNO%<>RUZ% THEN RECNO%=RECNO%+1
    GET 1,RECNO%
    GOSUB EKRAN.YAZ
    RETURN
CIK:
   CLOSE 1
   CLS
   END