$INCLUDE "KUTUP.BAS"

CONST:
  DIM YAZI$(101)

FILE.OPEN:
  OPEN "OGR.DAT" FOR RANDOM AS #1 LEN =36
  FIELD #1,10 AS NO$,20 AS ADI$,3 AS VIZE$,3 AS FINAL$

SCREEN.DIZAYN:
  A$=FNEKRAN$("OGR2.SCR")

READING:


SIRANO:
   UNVAN$="" : OKULNO$="" : VIZE1$="" : FINAL1$=""
   RUZ%=LOF(1)/36+1 : RECNO%=RUZ%
KKK:
   SIRANO$=MID$(STR$(RECNO%),2)
   SIRANO$=FNINPUT$(6,34,4,SIRANO$,1)
   IF VAL(SIRANO$)>RUZ% THEN GOTO SIRANO
   SIRANO$=FNSIFIR$(SIRANO$,4)
   LOCATE 6,34 : PRINT SIRANO$
   IF TUS=27 THEN GOTO CIK
   IF TUS=73 THEN GOSUB PGUP : GOTO KKK
   IF TUS=81 THEN GOSUB PGDN : GOTO KKK
   GOSUB KAYIT.KONTROL
   IF VAR=1 THEN KOM$="234"+CHR$(27) : GOTO JOBS ELSE KOM$="1234"+CHR$(27)
OKULNO:
   OKULNO$=FNINPUT$(7,34,10,OKULNO$,1)
   IF TUS=72 AND DUZELT=0 THEN GOTO SIRANO
UNVAN:
   UNVAN$=FNINPUT$(8,34,20,UNVAN$,0)
   IF TUS=72 THEN GOTO OKULNO
VIZE:
    VIZE1$=FNINPUT$(9,34,3,VIZE1$,1)
    IF TUS=72 THEN GOTO UNVAN
FINAL:
    FINAL1$=FNINPUT$(10,34,3,FINAL1$,1)
    IF TUS=72 THEN GOTO VIZE
    IF DUZELT=1 THEN RETURN

JOBS:
    KB$=FNMESAJ$("1-KAYIT  2-DUZELT   3-SiL   4-VAZGEÄ    ESC = ÄIKIS",KOM$)
    SELECT CASE  KB$
      CASE "1" : GOSUB KAYIT
      CASE "2" : GOSUB DUZELT
      CASE "3" : GOSUB SIL
      CASE "4" : GOTO SCREEN.DIZAYN
      CASE CHR$(27) : GOTO CIK
      END SELECT
      GOTO SCREEN.DIZAYN

KAYIT:
    LSET NO$=OKULNO$ :LSET ADI$=UNVAN$
    LSET VIZE$=VIZE1$ : LSET FiNAL$=FiNAL1$
    PUT #1,RECNO%
    RETURN

SIL:
    KB$=FNMESAJ$("Eminmisiniz. (Evet Hayir)","EHeh")
    IF KB$="H" THEN RETURN
    LSET NO$="Q" :LSET ADI$=""
    LSET VIZE$="": LSET FiNAL$=""
    PUT #1,RECNO%
    RETURN
DUZELT:
    DUZELT=1 : GOSUB OKULNO
    KB$=FNMESAJ$("DÅzeltmeleri Kayit Edeyimmi? (Evet Hayir)","EHeh")
    IF KB$="H" THEN RETURN
    GOSUB KAYIT
    RETURN

KAYIT.KONTROL:
    VAR=0
    RECNO%=VAL(SIRANO$)
    IF RUZ%=RECNO% THEN VAR=0 : RETURN
    GET #1,RECNO%
    IF NO$="Q" THEN VAR=0 ELSE VAR=1
    GOSUB EKRAN.YAZ
    RETURN
EKRAN.YAZ:
    OKULNO$=NO$ : UNVAN$=ADI$
    VIZE1$=VIZE$: FINAL1$=FINAL$
    LOCATE 7,34,0 : PRINT OKULNO$
    LOCATE 8,34,0 : PRINT UNVAN$
    LOCATE 9,34,0 : PRINT VIZE1$
    LOCATE 10,34  : PRINT FINAL1$
    RETURN

PGUP:
   IF RECNO%<>1 THEN RECNO%=RECNO%-1
   GET #1,RECNO%
   GOSUB EKRAN.YAZ
   RETURN
PGDN:
   IF RECNO%<>RUZ% THEN RECNO%=RECNO%+1
   GET #1,RECNO%
   GOSUB EKRAN.YAZ
   RETURN

CIK:
    CLS
